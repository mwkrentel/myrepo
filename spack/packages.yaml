#
#  Sample packages.yaml file for hpctoolkit prereqs.
#
#  Copy this file to some directory (eg, config), and use:
#    spack -C config install ...
#
#  Needs hand-editing for some systems, especially for locations of
#  cmake and python.
#
packages:

  # We require cmake >= 3.x and python 2.7 or 3.x.  If these already
  # exist on your system and you don't want spack to rebuild them,
  # then you can specify 'paths:' or 'modules:' for them here.
  # See spack docs: Build customization --> Externals Packages.

  # cmake:
  #   modules:
  #     cmake@3.8.2:  CMake/3.8.2
  #   buildable: False

  # python:
  #   paths:
  #     python@2.7.15:  /usr
  #   buildable: False


  # binutils: the api changed in 2.29, so toolkit needs <= 2.28 for now.
  # +libiberty is needed for xmalloc functions in libbfd
  # ~nls is needed to avoid linking libintl from gettext
  # ~gold is to reduce prereqs
  binutils:
    version:  [2.28]
    variants: +libiberty ~nls ~gold


  # boost: need >= 1.55 for multi-index containers.
  # +atomic, +chrono, +shared, etc, are all for dyninst
  # ~debug is to build release version
  # ~mpi, ~python, etc, are to reduce prereqs
  # ~wave, ~regex, etc, are to eliminate large libs
  boost:
    version:  [1.66.0]
    variants: >
       +atomic +chrono +date_time +filesystem +system +thread +timer
       +shared +multithreaded ~debug
       ~mpi ~python ~iostreams ~numpy
       ~wave ~regex ~log ~locale


  # bzip has stopped development, but 1.0.6 is fine.
  bzip2:
    version:  [1.0.6]
    variants: +shared


  # dyninst: normally want latest version from master.
  # somewhat in flux until 10.x is released
  dyninst:
    version:  [develop]


  # elfutils: need recent version >= 0.173 for dwarf parsing.
  # +bzip2, +xz for reading compressed sections
  # ~nls to avoid linking libintl from gettext
  elfutils:
    version:  [0.173]
    variants: +bzip2 +xz ~nls


  # intel-tbb: any recent version is good.
  # ~tm for old systems that don't support transactional memory
  intel-tbb:
    version:  [2018.4]
    variants: +shared +tm


  # intel-xed: any recent version is good.
  # +debug for debug symbols (-g)
  intel-xed:
    version:  [2018.02.14]
    variants: +debug


  # libdwarf: want fairly recent version.
  libdwarf:
    version:  [20180129]


  # libiberty: any recent version is good.
  # +pic is needed for dyninst shared library
  libiberty:
    version:  [2.31.1]
    variants: +pic


  # libmonitor: always want latest version.
  # +hpctoolkit is needed for client signals
  libmonitor:
    version:  [2018.07.18]
    variants: +hpctoolkit


  # libpfm4 (perfmon): normally want latest version.
  libpfm4:
    version:  [4.10.1]


  # libunwind: always want most recent version.
  # +xz for reading compressed symbol tables
  libunwind:
    version:  [1.3-rc1]
    variants: +xz


  # xerces: any recent version is good.
  # fixme: may need to do something with libiconv
  xerces-c:
    version:  [3.2.1]


  # xz (lzma): any recent version is good.
  xz:
    version:  [5.2.4]


  # zlib: any recent version is good.
  # +optimize to add -O2
  zlib:
    version:  [1.2.11]
    variants: +optimize +shared

